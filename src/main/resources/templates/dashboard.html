<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | BioQuiz</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
</head>
<body>
<div class="app-shell">
    <aside class="sidebar">
        <div class="brand">
            <p class="eyebrow">BioQuiz</p>
            <h2>Control Panel</h2>
        </div>
        <nav class="nav">
            <button type="button" class="nav-button is-active" data-target="home" data-title="Home"
                    data-description="Rezumatul activității tale și lucruri rapide de făcut.">
                Home
            </button>
            <button type="button" class="nav-button" data-target="tests" data-title="Teste"
                    data-description="Planifică sau continuă testele de biologie.">
                Teste
            </button>
            <button type="button" class="nav-button" data-target="results" data-title="Rezultate"
                    data-description="Ultimele scoruri și feedback detaliat.">
                Rezultate
            </button>
            <button type="button" class="nav-button" data-target="statistics" data-title="Statistici"
                    data-description="Tendințe și progres pe capitole.">
                Statistici
            </button>
        </nav>
        <form class="logout-form" th:action="@{/logout}" method="post">
            <button class="ghost-button" type="submit">Log out</button>
        </form>
    </aside>
    <main class="content">
        <header class="content-header">
            <p class="eyebrow">Secțiune curentă</p>
            <h1 id="section-title">Home</h1>
            <p class="subtitle" id="section-description">Rezumatul activității tale și lucruri rapide de făcut.</p>
        </header>
        <section class="panel is-active" id="view-home">
            <div class="panel-grid">
                <article>
                    <p class="eyebrow">Teste finalizate</p>
                    <h3 th:text="${resultsCount != null ? resultsCount : 0}">0</h3>
                    <p class="subtitle">Numărul testelor completate de tine.</p>
                </article>
                <article>
                    <p class="eyebrow">Media notelor</p>
                    <h3 th:text="${avgScore != null ? avgScore : 0}">0</h3>
                    <p class="subtitle">Pe scala 1-10.</p>
                </article>
                <article>
                    <div th:if="${role == 'TEACHER'}">
                        <p class="eyebrow">Teste create</p>
                        <h3 th:text="${teacherTestsCount != null ? teacherTestsCount : 0}">0</h3>
                        <p class="subtitle" th:text="'Total întrebări: ' + (${teacherQuestionsCount != null ? teacherQuestionsCount : 0})">Întrebări</p>
                    </div>
                    <div th:if="${role != 'TEACHER'}">
                        <p class="eyebrow">Ultimul rezultat</p>
                        <h3 th:text="${lastScore != null ? lastScore + '/10' : 'N/A'}">N/A</h3>
                        <p class="subtitle" th:text="${lastTestName != null ? lastTestName : 'Fă un test pentru a vedea rezultate'}"></p>
                    </div>
                </article>
            </div>
            <div class="panel-card">
                <h2>Ce urmează</h2>
                <ul class="checklist">
                    <li th:if="${role == 'TEACHER'}">Adaugă întrebări la testele tale din secțiunea Teste.</li>
                    <li th:if="${role == 'TEACHER'}">Asigură-te că fiecare întrebare are răspunsul corect setat.</li>
                    <li th:if="${role != 'TEACHER'}">Finalizează un test sau quiz pentru a-ți vedea progresul.</li>
                    <li th:if="${role != 'TEACHER'}">Reia testele pentru a-ți crește media.</li>
                </ul>
            </div>
        </section>
        <section class="panel" id="view-tests">
            <div class="panel-card">
                <div th:if="${role == 'TEACHER'}">
                    <h2>Teste (profesor)</h2>
                    <p>Gestionează testele direct din aplicație.</p>
                    <div class="button-row">
                        <a class="primary-button" th:href="@{/tests}">Creează / vezi testele</a>
                    </div>
                </div>
                <div th:if="${role != 'TEACHER'}">
                    <h2>Teste disponibile</h2>
                    <p>Vezi ce teste a creat profesorul și rezolvă-le.</p>
                    <div class="button-row">
                        <a class="primary-button" th:href="@{/tests/available}">Vezi testele</a>
                    </div>
                </div>
            </div>
            <div class="panel-card">
                <h2>Quiz rapid (10 întrebări)</h2>
                <p>Răspunde la un set de întrebări de biologie și vezi nota 1-10.</p>
                <a class="secondary-button" th:href="@{/quiz/simple}">Începe quiz-ul</a>
            </div>
        </section>
        <section class="panel" id="view-results">
            <div class="panel-card">
                <h2>Rezultate recente</h2>
                <div th:if="${results == null || #lists.isEmpty(results)}">
                    <p class="subtitle">Nu ai rezultate încă. Încearcă un test.</p>
                </div>
                <div class="table" th:if="${results != null && !#lists.isEmpty(results)}">
                    <div class="table-row table-head">
                        <span>Test</span>
                        <span>Data</span>
                        <span>Scor</span>
                    </div>
                    <div class="table-row" th:each="r : ${results}">
                        <span th:text="${r.testName}">Test</span>
                        <span th:text="${#temporals.format(r.createdAt, 'dd MMM HH:mm')}">Data</span>
                        <span class="tag tag-green" th:text="${r.score} + '/10'">10/10</span>
                    </div>
                </div>
            </div>
        </section>
        <section class="panel" id="view-statistics">
            <div class="panel-card">
                <h2>Statistici personale</h2>
                <div class="panel-grid">
                    <article>
                        <p class="eyebrow">Număr teste</p>
                        <h3 th:text="${resultsCount != null ? resultsCount : 0}">0</h3>
                        <p class="subtitle">Teste finalizate de tine.</p>
                    </article>
                    <article>
                        <p class="eyebrow">Media notelor</p>
                        <h3 th:text="${avgScore != null ? avgScore : 0}">0</h3>
                        <p class="subtitle">Pe scala 1-10.</p>
                    </article>
                </div>
            </div>
        </section>
    </main>
</div>
<script th:src="@{/js/dashboard.js}"></script>
</body>
</html>
